---
title: "WSL2でWindowsがBMP形式でコピーした画像を貼り付けられない問題を修正"
date: 2026-02-19
tags: [bug-fix, windows, wsl2, image, paste]
---

## 原文（日本語に翻訳）

WindowsがBMP形式で画像をコピーするWSL2システムで画像の貼り付けが機能しない問題を修正しました（anthropics/claude-code#25935）。

## 原文（英語）
Fixed image pasting not working on WSL2 systems where Windows copies images as BMP format (anthropics/claude-code#25935)

## 概要

Windows上のWSL2（Windows Subsystem for Linux 2）環境でClaude Codeを使用する際、Windowsがクリップボードに画像をBMP形式で保存することがあり、その場合にClaude Codeへの画像貼り付けが動作しないバグが修正されました。修正後はBMP形式でクリップボードにコピーされた画像も正しく貼り付けてClaudeに送信できます。

## 基本的な使い方

```bash
# WSL2 環境での画像貼り付け

# 1. Windowsでスクリーンショットを撮影（PrintScreen や Snipping Tool）
#    → クリップボードにBMP形式で画像がコピーされる

# 2. WSL2 の Claude Code で貼り付け
claude
> [Ctrl+V または右クリックでペースト]

# 修正前: 画像が貼り付けられない、またはエラーが発生
# 修正後: BMP形式の画像も正しく認識されてClaudeに送信される
```

## 実践例

### ユースケース1: スクリーンショットを使ったUIデバッグ

Windowsアプリのスクリーンショットを使ってUIの問題を診断する場合。

```bash
# 1. Windowsで問題のあるUIのスクリーンショットを撮影
#    (Win + Shift + S で Snipping Tool を使用)
#    → クリップボードにBMPまたはPNG形式で保存される

# 2. WSL2のClaude Codeに貼り付けて質問
claude
> このスクリーンショットのUIで何が問題か教えてください
> [Ctrl+V で画像を貼り付け]

# 修正後: BMP形式でコピーされた場合も正常に処理される
# Claude: "ボタンのアライメントが崩れています。CSSの..."
```

### ユースケース2: エラーダイアログのキャプチャを分析

Windowsアプリのエラーダイアログをキャプチャして分析する場合。

```bash
# Windowsアプリでエラーが発生した場合
# Alt+PrintScreen でアクティブウィンドウをキャプチャ
# → BMPとしてクリップボードに保存

# WSL2でClaude Codeに貼り付け
claude
> 以下のエラーダイアログを解析してください
> [Ctrl+V で画像を貼り付け]

# 修正後の動作:
# Claude: "エラーコード 0x80070005 はアクセス拒否を意味します。
#          管理者権限で実行するか..."
```

### ユースケース3: ドキュメントの図表を貼り付けて解説依頼

WordやExcelの図表をコピーしてClaude Codeで分析する場合。

```bash
# Word/Excel の図や表を選択してコピー（Ctrl+C）
# Windowsはこれを内部的にBMPとしてクリップボードに保存することがある

# WSL2のClaude Codeで貼り付け
claude
> このシステムアーキテクチャ図を説明してください
> [Ctrl+V で図を貼り付け]

# または表データの場合
> このExcelの表を分析して傾向を教えてください
> [Ctrl+V で表の画像を貼り付け]

# 修正後: Office系アプリからコピーした画像も正しく処理される
```

## 注意点

- この修正はWSL2環境に特有の問題でした。Linux/macOS環境では影響しません
- WindowsがBMP形式でクリップボードに保存するのは主に: PrintScreen、Alt+PrintScreen、一部のアプリからのコピー時です
- Snipping Tool（Win+Shift+S）は通常PNG形式でコピーするため、修正前でも動作することがありました
- BMP画像はPNGやJPEGと比べてファイルサイズが大きい場合があります。非常に大きな画像はAPIの制限に引っかかる可能性があります
- WSL2でのクリップボードアクセスには `wl-paste` や `win32yank` などのツールが使用されることがあります

## 関連情報

- [Claude Code 公式ドキュメント](https://docs.anthropic.com/ja/docs/claude-code/overview)
- [CHANGELOG.md](https://github.com/anthropics/claude-code/blob/main/CHANGELOG.md)
- [GitHub Issue #25935](https://github.com/anthropics/claude-code/issues/25935)
- [Claude Code WSL設定ガイド](https://docs.anthropic.com/ja/docs/claude-code/setup)
- [Microsoft WSL2 ドキュメント](https://learn.microsoft.com/ja-jp/windows/wsl/)
