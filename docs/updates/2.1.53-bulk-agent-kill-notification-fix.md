---
title: "バルクエージェント終了（Ctrl+F）の通知とキュークリアを修正"
date: 2026-02-25
tags: [バグ修正, エージェント, 通知, UI]
---

## 原文（日本語に翻訳）

バルクエージェント終了（Ctrl+F）を修正し、エージェントごとに1つずつではなく単一の集約通知を送信し、コマンドキューを正しくクリアするようにしました

## 原文（英語）

Fixed bulk agent kill (ctrl+f) to send a single aggregate notification instead of one per agent, and to properly clear the command queue

## 概要

Claude Codeで複数のバックグラウンドエージェントを一括終了する `Ctrl+F` 操作に関する2つの問題を修正しました。修正前は、終了するエージェントの数だけ通知が表示されていましたが、修正後は1つの集約通知のみ表示されます。また、エージェント終了後にコマンドキューが正しくクリアされるようになりました。

## 基本的な使い方

```bash
# Claude Codeでバックグラウンドエージェントを起動
claude

# 複数のサブエージェントが実行中の場合
# Ctrl+F で全エージェントを一括終了

# 修正前:
# 通知1: "Agent task1 terminated"
# 通知2: "Agent task2 terminated"
# 通知3: "Agent task3 terminated"
# (エージェントの数だけ通知が来る)

# 修正後:
# 通知: "3 agents terminated"
# (1つの集約通知のみ)
```

## 実践例

### 複数エージェントの一括終了

```bash
claude

# 複数のタスクを並行実行中
# 例: ファイル分析、コード生成、テスト実行を並行して依頼

# タスク実行中に全エージェントを終了したい場合
# Ctrl+F を押す

# 修正後の動作:
# 1. 全実行中エージェントが終了
# 2. 通知は1件のみ表示: "N個のエージェントを終了しました"
# 3. コマンドキューがクリアされる（次のコマンドが意図せず実行されない）
```

### コマンドキューの確認

```bash
# バルク終了前にキューに入っているコマンドを確認
# (UIでキューに積まれたコマンドが表示される場合)

# Ctrl+F でエージェント終了
# 修正後: キューに積まれていたコマンドもクリアされる
# 修正前: キューに残ったコマンドが次のセッションで意図せず実行される場合があった
```

### エージェント管理のベストプラクティス

```bash
claude

# 長時間タスクの開始
> 大規模なコードベース全体を分析してください

# 途中でキャンセルしたい場合
# Ctrl+C: 現在のエージェントのみ停止
# Ctrl+F: 全エージェントを一括停止（修正後は1通知、クリーンな状態）

# タスクの状態を確認
> 現在実行中のタスクを表示してください
```

## 注意点

- この修正は v2.1.53 で適用されています
- `Ctrl+F` は複数のエージェントが同時に実行されているときに特に有用です
- コマンドキューのクリアにより、意図しないコマンドの実行を防げるようになりました
- バルク終了後は新しいセッションやタスクを安全に開始できます
- 単一エージェントの停止には `Ctrl+C` を使用します

## 関連情報

- [Claude Code サブエージェント機能](https://docs.anthropic.com/en/docs/claude-code/sub-agents)
- [Claude Code ドキュメント](https://docs.anthropic.com/en/docs/claude-code)
- [バグ報告](https://github.com/anthropics/claude-code/issues)
