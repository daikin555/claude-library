---
title: "--add-dir ディレクトリからのプラグイン設定読み込みサポート"
date: 2026-02-17
tags: [plugin, add-dir, configuration, enabledPlugins]
---

## 原文（日本語に翻訳）

`--add-dir` ディレクトリから `enabledPlugins` および `extraKnownMarketplaces` の読み込みサポートを追加

## 原文（英語）

Added support for reading `enabledPlugins` and `extraKnownMarketplaces` from `--add-dir` directories

## 概要

Claude Code 2.1.45 から、`--add-dir` フラグで指定した追加ディレクトリ内の設定ファイルに記述された `enabledPlugins` と `extraKnownMarketplaces` が読み込まれるようになりました。これにより、プロジェクトやチームごとに異なるプラグイン設定を持つディレクトリを切り替えて使用することが容易になります。複数のプロジェクト環境を管理する際に、設定の一元管理が可能になります。

## 基本的な使い方

`--add-dir` で指定したディレクトリの `.claude/settings.json` に `enabledPlugins` を記述します。

```bash
# 追加ディレクトリを指定して Claude Code を起動
claude --add-dir /path/to/shared-config
```

`/path/to/shared-config/.claude/settings.json` の例：

```json
{
  "enabledPlugins": ["my-plugin", "team-plugin"],
  "extraKnownMarketplaces": [
    {
      "name": "社内マーケットプレイス",
      "url": "https://marketplace.example.com"
    }
  ]
}
```

## 実践例

### チーム共有の設定ディレクトリを使う

チームで共有するプラグイン設定を一箇所で管理し、各開発者が `--add-dir` で参照する構成です。

```bash
# 共有設定リポジトリをクローン
git clone https://github.com/your-org/claude-team-config ~/team-claude-config

# 共有設定を参照して Claude Code を起動
claude --add-dir ~/team-claude-config
```

`~/team-claude-config/.claude/settings.json`:

```json
{
  "enabledPlugins": ["code-review-plugin", "security-scanner"],
  "extraKnownMarketplaces": [
    {
      "name": "社内プラグインストア",
      "url": "https://plugins.internal.example.com"
    }
  ]
}
```

### プロジェクトごとに異なるプラグインセットを使う

プロジェクト A とプロジェクト B で異なるプラグインを有効化する場合：

```bash
# プロジェクト A（フロントエンド向けプラグイン）
claude --add-dir ~/configs/frontend-project

# プロジェクト B（バックエンド向けプラグイン）
claude --add-dir ~/configs/backend-project
```

`~/configs/frontend-project/.claude/settings.json`:
```json
{
  "enabledPlugins": ["react-helper", "css-analyzer"]
}
```

`~/configs/backend-project/.claude/settings.json`:
```json
{
  "enabledPlugins": ["db-migration-helper", "api-tester"]
}
```

## 注意点

- `--add-dir` で指定するパスには `.claude/settings.json` が存在する必要があります。
- `enabledPlugins` に記載するプラグイン名は、インストール済みのプラグインと一致している必要があります。
- `extraKnownMarketplaces` はカスタムマーケットプレイスの URL を指定します。社内プライベートマーケットプレイスを登録する際に使用します。
- 複数の `--add-dir` を指定した場合、後から指定したディレクトリの設定が優先されます（マージ動作はプラグインによって異なります）。

## 関連情報

- [Claude Code 設定ドキュメント](https://docs.anthropic.com/ja/docs/claude-code/settings)
- [Claude Code プラグインガイド](https://docs.anthropic.com/ja/docs/claude-code/plugins)
