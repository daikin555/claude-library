---
title: "VS Code拡張機能のWindowsクラッシュ修正"
date: 2026-02-24
tags: [vscode, windows, bugfix, extension]
---

## 原文（日本語に翻訳）

VS Code: Windowsでの拡張機能クラッシュを修正（「コマンド 'claude-vscode.editor.openLast' が見つかりません」）

## 原文（英語）

VS Code: Fixed extension crash on Windows ("command 'claude-vscode.editor.openLast' not found")

## 概要

Windows環境でVS Code拡張機能を使用中に `claude-vscode.editor.openLast` コマンドが見つからないエラーが発生し、拡張機能がクラッシュする問題が修正されました。このバグはWindows固有の問題で、コマンドの登録タイミングに起因するものでした。v2.1.52へのアップデートにより、Windows上でも安定してClaude Code VS Code拡張機能が動作するようになります。

## 基本的な使い方

修正はv2.1.52に含まれており、拡張機能を最新バージョンに更新することで自動的に適用されます。

```bash
# Claude Code CLIを最新バージョンに更新
claude update

# またはnpm経由でのアップデート（非推奨）
npm update -g @anthropic-ai/claude-code
```

VS Code拡張機能はVS Codeのマーケットプレイスから自動更新されます。

## 実践例

### Windows環境での拡張機能再起動

クラッシュが発生した場合は、拡張機能を再起動することで解決できます：

1. VS Codeコマンドパレット（`Ctrl+Shift+P`）を開く
2. 「Developer: Reload Window」を実行
3. Claude Code拡張機能が正常に起動することを確認

### クラッシュが発生していた状況の確認

```
# エラーメッセージの例（修正前）
Error: command 'claude-vscode.editor.openLast' not found
```

このエラーはWindows環境でClaude Codeの「最後に開いたファイル」機能を使おうとした際に発生していました。

### VS Code拡張機能の手動更新

```
1. VS Code左側の拡張機能パネルを開く（Ctrl+Shift+X）
2. 「Claude Code」を検索
3. 「更新」ボタンが表示されている場合はクリック
4. VS Codeを再起動
```

## 注意点

- この修正はWindows環境に特有のものです。macOSやLinuxユーザーはこのバグの影響を受けていませんでした。
- VS Code拡張機能の自動更新が有効な場合、次回VS Code起動時に自動的にアップデートが適用されます。
- 拡張機能のバージョンとClaude Code CLIのバージョンは独立して管理されます。両方を最新に保つことを推奨します。

## 関連情報

- [Claude Code公式ドキュメント](https://code.claude.com/docs/en/overview)
- [Claude Code GitHubリポジトリ](https://github.com/anthropics/claude-code)
- [Claude Code CHANGELOG](https://github.com/anthropics/claude-code/blob/main/CHANGELOG.md)
- [VS Code Marketplace - Claude Code](https://marketplace.visualstudio.com/items?itemName=Anthropic.claude-code)
