---
title: "plugin enable/disableコマンドがスコープを自動検出するようになりました"
date: 2026-02-20
tags: [bug-fix, improvement, plugins, scope]
---

## 原文（日本語に翻訳）

`plugin enable` と `plugin disable` を修正し、`--scope` が指定されていない場合に常にユーザースコープをデフォルトとする代わりに、正しいスコープを自動検出するようにしました。

## 原文（英語）

Fixed `plugin enable` and `plugin disable` to auto-detect the correct scope when `--scope` is not specified, instead of always defaulting to user scope

## 概要

`claude plugin enable` と `claude plugin disable` コマンドが、`--scope` フラグを省略した際に常にユーザースコープ（`~/.claude`）を使用していた問題が修正されました。修正後は、プラグインがどのスコープで管理されているかを自動検出し、適切なスコープで操作を実行するようになります。これにより、プロジェクトスコープのプラグインを操作する際に誤ってユーザースコープを変更してしまう問題が解消されます。

## 基本的な使い方

```bash
# 修正前: --scope を省略すると常にユーザースコープで操作されていた
claude plugin enable my-plugin          # → ユーザースコープで有効化（意図しない動作）
claude plugin disable my-plugin         # → ユーザースコープで無効化（意図しない動作）

# 修正後: プラグインが存在するスコープを自動検出
claude plugin enable my-plugin          # → 適切なスコープで自動的に有効化
claude plugin disable my-plugin         # → 適切なスコープで自動的に無効化
```

## 実践例

### ユースケース1: プロジェクトスコープのプラグインを操作

プロジェクトディレクトリにインストールされたプラグインを有効化/無効化する場合。

```bash
# プロジェクトディレクトリ: ~/projects/my-app
# プラグインは .claude/plugins/ にインストールされている

# 修正前の問題: プロジェクトスコープのプラグインが見つからず、
# ユーザースコープを変更してしまっていた
cd ~/projects/my-app
claude plugin disable my-project-plugin
# 修正前: ~/.claude/plugins/ (ユーザースコープ) を変更 → プラグインが見つからないか、意図しない変更

# 修正後: プロジェクトスコープを自動検出
claude plugin disable my-project-plugin
# → .claude/plugins/ (プロジェクトスコープ) を正しく変更
```

### ユースケース2: スコープ確認なしでの安全な操作

スコープを意識せずに直感的にプラグインを管理する場合。

```bash
# ユーザースコープのプラグインを一時的に無効化
claude plugin disable typescript-helper
# → ユーザースコープにあるプラグインを検出して無効化

# プロジェクトスコープのプラグインを有効化
cd ~/projects/new-project
claude plugin enable project-specific-linter
# → プロジェクトスコープにあるプラグインを検出して有効化
```

### ユースケース3: 明示的なスコープ指定（変更なし）

明示的に `--scope` を指定する場合は従来通りの動作。

```bash
# 明示的なスコープ指定は引き続き利用可能
claude plugin enable my-plugin --scope user      # ユーザースコープで有効化
claude plugin enable my-plugin --scope project   # プロジェクトスコープで有効化
claude plugin enable my-plugin --scope system    # システムスコープで有効化
```

## 注意点

- この修正は `--scope` を省略した場合にのみ適用されます。明示的に `--scope` を指定した場合の動作は変わりません。
- プラグインが複数のスコープに存在する場合、最も具体的なスコープ（プロジェクト > ユーザー > システム）が優先される可能性があります。
- スコープの自動検出が期待通りに動作しない場合は、`--scope` フラグで明示的に指定してください。
- プラグイン管理コマンド: `claude plugin list`、`claude plugin install`、`claude plugin uninstall`、`claude plugin enable`、`claude plugin disable`

## 関連情報

- [Claude Code 公式ドキュメント - プラグイン](https://docs.anthropic.com/ja/docs/claude-code/plugins)
- [Claude Code CHANGELOG](https://github.com/anthropics/claude-code/blob/main/CHANGELOG.md)
- [プラグインのsettings.json対応](./2.1.49-plugin-settings-json.md)
