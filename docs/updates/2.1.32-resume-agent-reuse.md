---
title: "--resumeで以前の--agent設定を自動再利用"
date: 2026-02-05
tags: [resume, agent, cli-options, workflow]
---

## 原文（日本語訳）
`--resume` が、以前の会話で指定された `--agent` の値をデフォルトで再利用するようになりました。

## 原文（英語）
Updated --resume to re-use --agent value specified in previous conversation by default.

## 概要
会話を再開する際に `--resume` オプションを使用すると、以前の会話で指定された `--agent` オプションの値が自動的に引き継がれるようになりました。これにより、同じエージェント設定で作業を続ける際の手間が省けます。

## 基本的な使い方

以前は、会話を再開する際に毎回 `--agent` を指定する必要がありましたが、今は自動的に引き継がれます。

### 修正前の動作

```bash
# 最初の会話
claude --agent explore "コードベースを調査してください"

# 会話を再開（以前は --agent を再指定する必要があった）
claude --resume conv_abc123 --agent explore
```

### 修正後の動作

```bash
# 最初の会話
claude --agent explore "コードベースを調査してください"

# 会話を再開（--agent は自動的に引き継がれる）
claude --resume conv_abc123
# 自動的に --agent explore が適用される
```

## 実践例

### 長期的な探索作業の継続

コードベースの探索作業を複数日にわたって続ける場合：

```bash
# 1日目: 探索開始
claude --agent explore "認証システムのアーキテクチャを調査"
# 会話ID: conv_20240205_001

# 2日目: 作業再開
claude --resume conv_20240205_001
# 自動的に explore エージェントで再開される
```

### 特定エージェントでの反復作業

特定のエージェントタイプで繰り返し作業する場合：

```bash
# 計画フェーズ
claude --agent plan "新機能の実装計画を立てる"
# 会話ID: conv_20240205_002

# 計画を修正・継続
claude --resume conv_20240205_002
# 自動的に plan エージェントで継続
```

### バックグラウンドエージェントタスクの確認

バックグラウンドで実行したエージェントタスクの結果を後で確認：

```bash
# バックグラウンドでテスト実行
claude --agent test-runner "全テストを実行" &
# 会話ID: conv_20240205_003

# 後で結果を確認
claude --resume conv_20240205_003
# 自動的に test-runner エージェントのコンテキストで再開
```

### エージェント設定の上書き

必要に応じて、異なるエージェントで再開することも可能です：

```bash
# 最初は explore エージェント
claude --agent explore "データベース設計を調査"
# 会話ID: conv_20240205_004

# 別のエージェントで同じ会話を継続
claude --resume conv_20240205_004 --agent plan
# plan エージェントで再開（上書き）
```

### マルチステップワークフローの継続

複数ステップにわたる作業を中断・再開する場合：

```bash
# ステップ1: 設計
claude --agent plan "API設計を作成"
# 会話ID: conv_20240205_005

# （作業中断）

# ステップ2: 設計の続きを再開
claude --resume conv_20240205_005
# 自動的に plan エージェントで続行
> 前回の設計を基に実装プランを詳細化してください
```

## 会話IDの確認方法

過去の会話IDを確認する方法：

```bash
# 会話履歴を一覧表示
claude --list

# 最近の会話を表示
claude --list --limit 10

# 特定のキーワードで検索
claude --list | grep "explore"
```

## エージェントタイプの確認

再開する会話がどのエージェントタイプを使用していたか確認：

```bash
# 会話の詳細を表示
claude --show-conversation conv_20240205_001

# または会話を再開して確認
claude --resume conv_20240205_001
> このエージェントタイプは何ですか？
```

## 注意点

- **エージェント設定の引き継ぎ**: `--resume` 時に `--agent` を明示的に指定すると、以前の設定は上書きされます
- **エージェントの互換性**: 異なるエージェントタイプで会話を再開すると、コンテキストが適切に引き継がれない場合があります
- **会話の一貫性**: 同じエージェントタイプで再開することで、作業の一貫性が保たれます
- **カスタムエージェント**: カスタムエージェントを使用していた場合も、その設定が引き継がれます
- **デフォルト動作**: `--agent` を指定せずに最初の会話を開始した場合は、デフォルトエージェントが使用されます

## 利用可能なエージェントタイプ

Claude Code で利用可能な主なエージェントタイプ：

- `general-purpose`: 汎用エージェント（デフォルト）
- `explore`: コードベース探索専用
- `plan`: 実装計画立案専用
- `bash`: Bash コマンド実行専用
- `test-runner`: テスト実行専用
- その他、カスタムエージェント

## ワークフローの最適化

### エイリアスの活用

頻繁に再開する会話にはエイリアスを設定：

```bash
# ~/.bashrc または ~/.zshrc に追加
alias resume-explore='claude --resume conv_20240205_001'
alias resume-plan='claude --resume conv_20240205_002'
```

### シェルスクリプトでの自動化

```bash
#!/bin/bash
# resume-last-conversation.sh

LAST_CONV=$(claude --list --limit 1 | grep -oE 'conv_[0-9_]+' | head -1)
claude --resume "$LAST_CONV"
```

使用：

```bash
chmod +x resume-last-conversation.sh
./resume-last-conversation.sh
```

## トラブルシューティング

### エージェント設定が引き継がれない場合

```bash
# Claude Code のバージョンを確認
claude --version
# 2.1.32 以降であることを確認

# 会話メタデータを確認
claude --show-conversation conv_abc123
```

### 異なるエージェントで再開したい場合

```bash
# 明示的に --agent を指定して上書き
claude --resume conv_abc123 --agent plan
```

## 関連情報

- [Claude Code Resume Option](https://github.com/anthropics/claude-code#resume)
- [Agent Types Documentation](https://github.com/anthropics/claude-code/blob/main/docs/agents.md)
- [Conversation Management](https://github.com/anthropics/claude-code/blob/main/docs/conversations.md)
- [CLI Options Reference](https://github.com/anthropics/claude-code#cli-options)
