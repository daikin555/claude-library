---
title: "Agent Teamsのモデル識別子エラー修正（Bedrock/Vertex/Foundry）"
date: 2026-02-11
tags: [Agent Teams, バグ修正, AWS Bedrock, Google Vertex AI, Foundry]
---

## 原文（日本語訳）

Agent TeamsがBedrock、Vertex、Foundryの顧客に対して誤ったモデル識別子を使用していた問題を修正しました。

## 原文（英語）

Fixed Agent Teams using wrong model identifier for Bedrock, Vertex, and Foundry customers

## 概要

Claude Code 2.1.39では、Agent Teams機能において、AWS Bedrock、Google Vertex AI、およびFoundryを利用する顧客に対して誤ったモデル識別子が使用されていた問題が修正されました。この修正により、これらのプラットフォームでAgent Teamsを使用する際の安定性と正確性が向上しました。

## 背景

Agent Teamsは、複数のClaude Codeインスタンスを協調させて作業を行う実験的機能です。各エージェントは異なるタスクを並行して実行し、チームリーダーが全体を調整します。しかし、異なるクラウドプラットフォーム（Bedrock、Vertex AI、Foundry）では、モデル識別子の形式が異なるため、正しい識別子を使用する必要があります。

## 影響を受けていた環境

### AWS Bedrock

```bash
# 修正前: 誤ったモデル識別子が使用されていた
# エラーメッセージの例:
# Error: Invalid model identifier for Bedrock

# 修正後: 正しいBedrock用モデル識別子が使用される
export CLAUDE_CODE_PROVIDER=bedrock
export CLAUDE_CODE_EXPERIMENTAL_AGENT_TEAMS=1
claude
```

### Google Vertex AI

```bash
# 修正前: Vertex AI特有の識別子形式が正しく処理されなかった
# Error: Model not found on Vertex AI

# 修正後: Vertex AI用の正しい識別子が使用される
export CLAUDE_CODE_PROVIDER=vertex
export CLAUDE_CODE_EXPERIMENTAL_AGENT_TEAMS=1
claude
```

### Foundry

```bash
# 修正前: Foundry環境でAgent Teamsが正常に動作しなかった

# 修正後: Foundryの正しいモデル識別子が使用される
export CLAUDE_CODE_PROVIDER=foundry
export CLAUDE_CODE_EXPERIMENTAL_AGENT_TEAMS=1
claude
```

## 実践例

### AWS Bedrockでのマルチエージェント開発

```bash
# AWS Bedrockを使用したAgent Teamsの設定
export AWS_REGION=us-east-1
export CLAUDE_CODE_PROVIDER=bedrock
export CLAUDE_CODE_EXPERIMENTAL_AGENT_TEAMS=1

# Claude Codeを起動
claude

# セッション内でAgent Teamを作成
# "Create an agent team with 3 members to refactor the authentication module"
```

### Google Vertex AIでの並列タスク実行

```bash
# Google Vertex AIでのAgent Teams設定
export GOOGLE_CLOUD_PROJECT=your-project-id
export CLAUDE_CODE_PROVIDER=vertex
export CLAUDE_CODE_EXPERIMENTAL_AGENT_TEAMS=1

# Agent Teamを使用した並列デバッグ
claude

# "Create a team of 4 agents to investigate different causes of the performance issue"
```

### エンタープライズ環境（Foundry）での活用

```bash
# Foundry環境でのセキュアなAgent Teams利用
export CLAUDE_CODE_PROVIDER=foundry
export FOUNDRY_API_KEY=your-api-key
export CLAUDE_CODE_EXPERIMENTAL_AGENT_TEAMS=1

# 大規模リファクタリング
claude

# "Set up an agent team to migrate the legacy codebase to the new architecture"
```

## 注意点

- **実験的機能**: Agent Teamsは現在も実験的な機能であり、`CLAUDE_CODE_EXPERIMENTAL_AGENT_TEAMS=1`の設定が必要です
- **プロバイダー設定**: 各クラウドプラットフォームに適した環境変数と認証情報を正しく設定してください
- **コスト管理**: Agent Teamsは複数のインスタンスを同時実行するため、API使用量とコストが増加します。特にBedrockやVertex AIでは課金に注意してください
- **モデル互換性**: 使用するモデルがAgent Teams機能に対応していることを確認してください（Claude Opus 4.6推奨）

## トラブルシューティング

この修正以前のバージョン（2.1.38以前）を使用している場合、以下のようなエラーが発生する可能性があります。

```
Error: Invalid model identifier
Error: Model not found
Error: Agent Teams initialization failed
```

これらのエラーが発生する場合は、Claude Code 2.1.39以降にアップデートしてください。

```bash
# アップデート方法
npm update -g @anthropic-ai/claude-code
# または
claude update
```

## 関連情報

- [Claude Code Agent Teams 公式ドキュメント](https://code.claude.com/docs/en/agent-teams)
- [AWS Bedrock でのClaude利用](https://aws.amazon.com/bedrock/)
- [Google Vertex AI でのClaude利用](https://cloud.google.com/vertex-ai)
- [Agent Teams セットアップガイド](https://serenitiesai.com/articles/claude-code-agent-teams-documentation)
