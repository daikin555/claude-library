---
title: "長時間実行のチームメイトがコンテキスト圧縮後もメッセージを保持し続けるメモリリーク修正"
date: 2026-02-28
tags: [bug-fix, memory, teammates, compaction, stability]
---

# 長時間実行のチームメイトがコンテキスト圧縮後もメッセージを保持し続けるメモリリーク修正

## 原文（日本語に翻訳）

長時間実行のチームメイトが会話圧縮後もAppStateにすべてのメッセージを保持し続けるメモリリークを修正しました。

## 原文（英語）

Fixed memory leak where long-running teammates retained all messages in AppState even after conversation compaction

## 概要

Claude Code v2.1.63で、チームメイト（複数のClaudeインスタンスが協調して作業する機能）における重要なメモリリークが修正されました。長時間実行されるチームメイトが、会話のコンテキスト圧縮（compaction）が行われた後も、AppStateにすべてのメッセージを保持し続ける問題がありました。修正により、圧縮後は適切にメモリが解放されます。

## 基本的な使い方

この修正はバックグラウンドで自動的に適用されます。ユーザー側での操作は不要です。

## 実践例

### 影響を受けるシナリオ

- 複数のClaudeインスタンスを使ったチームメイト機能での長時間セッション
- 長大な会話履歴を持つチームメイトセッション
- コンテキスト圧縮が発生するような長期作業

### 修正後の改善

```
# コンテキスト圧縮後のメモリ動作
修正前：
長時間セッション → コンテキスト圧縮 → メッセージはまだ保持 → メモリ増加継続

修正後：
長時間セッション → コンテキスト圧縮 → 古いメッセージが解放 → メモリ安定
```

## 注意点

- v2.1.63にアップデートすることで自動的に修正が適用されます
- チームメイト機能を使った長時間セッションで特に効果があります
- コンテキスト圧縮はClaude Codeが自動的に管理します

## 関連情報

- [Claude Code マルチエージェント機能](https://docs.anthropic.com/ja/docs/claude-code/agents)
