---
title: "起動時のMCP認証失敗キャッシュによるパフォーマンス改善"
date: 2026-02-22
tags: [performance, mcp, authentication, caching, startup]
---

## 原文（日本語に翻訳）

MCPの認証失敗をキャッシュすることで、冗長な接続試行を避け、起動パフォーマンスを改善しました。

## 原文（英語）

Improved startup performance by caching MCP auth failures to avoid redundant connection attempts

## 概要

Claude Codeの起動時に、認証が必要なMCPサーバーへの接続試行が毎回行われていたことによる起動遅延が改善されました。認証失敗の結果をキャッシュすることで、起動のたびに同じ失敗した接続試行を繰り返すことを防ぎます。特に複数のMCPサーバーを設定している環境で起動速度が向上します。

## 基本的な使い方

この改善はバックグラウンドで自動的に適用されます。特別な設定変更は不要です。

```bash
# 通常どおりClaudeを起動するだけで改善が適用されます
claude
# → 起動が高速化（特にMCPサーバーが複数設定されている場合）
```

## 実践例

### ユースケース1: 複数のMCPサーバーが設定されている環境

```json
// settings.json の設定例
{
  "mcpServers": {
    "server-a": {
      "url": "https://mcp-a.example.com/sse",
      "transport": "sse"
    },
    "server-b": {
      "url": "https://mcp-b.example.com/sse",
      "transport": "sse"
    }
  }
}
```

```bash
# 以前: 起動のたびに全サーバーへの接続試行（認証エラーでもタイムアウトまで待機）
# 修正後: キャッシュされた認証失敗を参照して即座にスキップ

claude
# → 起動時間が短縮される
```

### ユースケース2: 開発環境での頻繁な再起動

```bash
# 開発中に頻繁にClaudeを再起動する場合
# 認証エラーのキャッシュにより、毎回の接続待機が不要に

# 1回目の起動: 接続試行→失敗→キャッシュ
claude
# 2回目以降の起動: キャッシュから失敗を参照→即座にスキップ
claude
```

### ユースケース3: CI/CDパイプラインでの高速起動

```bash
# 自動化環境での繰り返し実行
# MCPサーバーへの認証失敗がキャッシュされ、各実行の起動が高速化

claude -p "テストを実行してください"
# → MCPサーバーの認証確認待機がなく、即座に処理開始
```

## 注意点

- 起動時のキャッシュは前回の起動情報を参照します。MCPサーバーの認証設定を修正した場合は、Claude Codeを再起動してキャッシュをリフレッシュしてください。
- セッション中の認証失敗キャッシュについては `2.1.49-mcp-auth-failure-caching.md` も参照してください。
- HTTP/SSEトランスポートのMCPサーバーに適用されます。

## 関連情報

- [Claude Code MCPドキュメント](https://docs.anthropic.com/ja/docs/claude-code/mcp)
- [Claude Code CHANGELOG](https://github.com/anthropics/claude-code/blob/main/CHANGELOG.md)
- [セッション中MCP認証キャッシュ](./2.1.49-mcp-auth-failure-caching.md)
- [MCP OAuth認証改善](./2.1.49-mcp-oauth-step-up-auth.md)
