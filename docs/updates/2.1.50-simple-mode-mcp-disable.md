---
title: "CLAUDE_CODE_SIMPLEモードがMCPツール・添付ファイル・フック・CLAUDE.mdの読み込みも無効化して完全な最小構成になりました"
date: 2026-02-21
tags: [enhancement, simple-mode, mcp, configuration]
---

## 原文（日本語に翻訳）

`CLAUDE_CODE_SIMPLE` モードがMCPツール、添付ファイル、フック、およびCLAUDE.mdファイルの読み込みも無効化し、完全に最小限の体験を提供するようになりました。

## 原文（英語）

`CLAUDE_CODE_SIMPLE` mode now also disables MCP tools, attachments, hooks, and CLAUDE.md file loading for a fully minimal experience.

## 概要

`CLAUDE_CODE_SIMPLE` モードが強化され、以前のスキル・セッションメモリ・カスタムエージェントの無効化に加えて、MCPツール・添付ファイル・フック・CLAUDE.mdファイルの読み込みも完全に無効化されるようになりました。これにより、どんな環境でもClaudeをクリーンな状態で起動できる「完全最小モード」として機能します。

## 基本的な使い方

`CLAUDE_CODE_SIMPLE=1` 環境変数を設定して起動するだけです。

```bash
# 完全最小モードで起動
CLAUDE_CODE_SIMPLE=1 claude

# または永続設定
export CLAUDE_CODE_SIMPLE=1
claude
```

v2.1.50時点での `CLAUDE_CODE_SIMPLE` で無効化される要素の完全一覧：

| 要素 | 無効化タイミング |
|------|-----------------|
| スキル | v2.1.50（修正済み） |
| セッションメモリ | v2.1.50（修正済み） |
| カスタムエージェント | v2.1.50（修正済み） |
| CLAUDE.mdのトークンカウント | v2.1.50（修正済み） |
| MCPツール | v2.1.50（新規追加） |
| 添付ファイル | v2.1.50（新規追加） |
| フック | v2.1.50（新規追加） |
| CLAUDE.mdファイル読み込み | v2.1.50（新規追加） |

## 実践例

### ユースケース1: 完全にクリーンなCI/CD環境での実行

CI環境でプロジェクトのカスタム設定を一切読み込まずにClaudeを実行する場合。

```bash
#!/bin/bash
# ci-claude.sh

# プロジェクトにCLAUDE.md、フック、MCPサーバーが設定されていても
# 完全にクリーンな状態でClaudeを実行できる
export CLAUDE_CODE_SIMPLE=1

claude -p "以下のコードをレビューして問題点を報告してください" \
  --no-interactive \
  < changed_files.txt
```

### ユースケース2: セキュリティ要件の厳しい環境

外部MCPサーバーや任意フックスクリプトの実行を防ぎたいセキュリティ要件がある場合。

```bash
# MCPサーバーへの接続を完全に防ぐ
CLAUDE_CODE_SIMPLE=1 claude

# フックスクリプトも実行されない
# CLAUDE.mdも読み込まれない
# → 攻撃面（attack surface）を最小化
```

### ユースケース3: 問題の切り分けとデバッグ

カスタム設定が問題を引き起こしているか確認するためのデバッグ。

```bash
# 通常モードで問題が発生する場合
claude -p "テストを実行して"
# → 何らかの問題が発生

# シンプルモードで同じ操作
CLAUDE_CODE_SIMPLE=1 claude -p "テストを実行して"
# → 正常に動作する場合、問題はCLAUDE.md/フック/MCPにある可能性

# 問題の特定
# 1. CLAUDE.mdを空にしてテスト
# 2. フックを無効化してテスト
# 3. MCPサーバーを削除してテスト
```

### ユースケース4: 最小限のAPIコスト最適化

CLAUDE.mdや大量のコンテキストによるトークンコストを削減したい場合。

```bash
# 大きなCLAUDE.mdがあるプロジェクトでも
# シンプルモードならトークンを節約
CLAUDE_CODE_SIMPLE=1 claude -p "短い質問への回答"
# → CLAUDE.md分のトークンが不要
```

## 注意点

- `CLAUDE_CODE_SIMPLE=1` はプロジェクト固有の設定をすべて無効化します。プロジェクト設定が必要な通常の開発作業には適していません。
- MCPツールが無効化されるため、MCPサーバーが提供するカスタムツール（ファイルシステムアクセスなど）は使用できません。
- フックが無効化されるため、ツール実行前後の検証フックなども動作しません。
- この設定は開発環境の分離、CI/CDパイプライン、セキュリティ要件がある環境での使用を想定しています。

## 関連情報

- [Claude Code 公式ドキュメント](https://docs.anthropic.com/ja/docs/claude-code/overview)
- [Claude Code CHANGELOG](https://github.com/anthropics/claude-code/blob/main/CHANGELOG.md)
- [CLAUDE_CODE_SIMPLE のスキル除去修正](./2.1.50-simple-mode-skills-strip-fix.md)
- [フックの使い方](https://docs.anthropic.com/ja/docs/claude-code/hooks)
