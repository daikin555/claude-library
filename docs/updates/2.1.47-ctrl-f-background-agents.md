---
title: "バックグラウンドエージェントの制御改善：ctrl+f で全エージェントを終了"
date: 2026-02-18
tags: [background-agents, keybinding, workflow]
---

## 原文（日本語に翻訳）

バックグラウンドエージェントをすべて終了するには、ESC の二度押しの代わりに `ctrl+f` を使用します。ESC でメインスレッドをキャンセルしても、バックグラウンドエージェントは継続して実行されるようになり、エージェントのライフサイクルをより細かく制御できます。

## 原文（英語）

Use `ctrl+f` to kill all background agents instead of double-pressing ESC. Background agents now continue running when you press ESC to cancel the main thread, giving you more control over agent lifecycle.

## 概要

これまでバックグラウンドエージェントを終了するには ESC を二度押しする必要がありました。v2.1.47 から、この操作が `ctrl+f` キーに変更されました。同時に、ESC でメインスレッドをキャンセルしてもバックグラウンドエージェントは継続して動作するようになりました。これによりメインスレッドとバックグラウンドエージェントのライフサイクルが分離され、より柔軟な操作が可能になります。

## 基本的な使い方

| キー操作 | 動作 |
|----------|------|
| `ESC` | メインスレッドのキャンセル（バックグラウンドエージェントは継続） |
| `ctrl+f` | バックグラウンドエージェントをすべて終了 |

```bash
# バックグラウンドエージェントを使った一般的な作業フロー
# 1. Claude に複数タスクを並行実行させる
# 2. メインスレッドで別の作業をしたい場合 → ESC（エージェントは継続）
# 3. すべてのエージェントを止めたい場合 → ctrl+f
```

## 実践例

### メインスレッドのみ中断してエージェントを継続させる

長時間かかるバックグラウンドエージェントのタスクを止めずに、メインスレッドでの別作業をする場合：

```
1. Claude に「テストを全部実行して、その後ドキュメントも更新して」と依頼
2. バックグラウンドエージェントがテスト実行中
3. 別のことを Claude に聞きたい → ESC でメインスレッドをキャンセル
4. エージェントはテストを継続
5. 新しい質問を入力して作業する
6. エージェントが完了したら結果を確認
```

### すべてのバックグラウンドエージェントを一括終了

誤った方向でエージェントが動いていることに気づいた場合：

```
1. エージェントが複数のファイルを並行して変更中
2. 方針が変わったのですべて止めたい
3. ctrl+f を押してすべてのエージェントを終了
4. 新しい指示で作業を再開
```

### ESC の新しい動作を理解する

```
以前の動作：
- ESC 1回 → 入力キャンセル
- ESC 2回 → バックグラウンドエージェントも終了

新しい動作：
- ESC 1回 → メインスレッドキャンセル（エージェントは動き続ける）
- ctrl+f → バックグラウンドエージェントをすべて終了
```

## 注意点

- **既存のワークフローに注意**：ESC の二度押しに慣れていた場合、エージェントが止まらないことに驚くかもしれません。新しいキーバインド `ctrl+f` を意識的に使いましょう。
- **エージェントの確認**：バックグラウンドエージェントが動いているかどうかはステータスバーで確認できます。
- **ctrl+f の用途変更**：従来 `ctrl+f` に割り当てていた操作がある場合は、キーバインド設定を確認してください。
- **段階的な制御**：ESC でメインスレッドのみを停止し、エージェントの結果を待ってから次の判断ができるようになりました。

## 関連情報

- [Claude Code キーボードショートカット一覧](https://code.claude.com/docs/en/cli-reference)
- [Claude Code バックグラウンドエージェントの使い方](https://code.claude.com/docs/en/extended-thinking)
- [Claude Code リリースノート](https://github.com/anthropics/claude-code/blob/main/CHANGELOG.md)
