---
title: "gh pr create でセッションが自動的にPRにリンクされる新機能"
date: 2026-01-30
tags: [github, pull-request, automation, workflow]
---

## 概要

Claude Code 2.1.27から、`gh pr create` コマンドでPRを作成すると、そのセッションが自動的にPRにリンクされるようになりました。これにより、後から該当PRの作業を簡単に再開できます。

## 使い方

### 基本的な使い方

Claude Codeのセッション内で `gh pr create` を実行するだけで、自動的にリンクが作成されます。

```bash
# Claude Codeを起動
claude

# セッション内で機能を実装
# > ユーザープロフィール編集機能を実装してください

# PRを作成（自動的にセッションがリンクされる）
# > PRを作成してください
```

Claudeが内部的に `gh pr create` を実行し、作成されたPRとセッションが自動的に関連付けられます。

### セッションの再開

リンクされたPRは `--from-pr` フラグで簡単に再開できます。

```bash
claude --from-pr 123
```

## 活用シーン

### 1. レビュー駆動開発

機能実装からPR作成、レビュー対応まで一貫した流れで作業できます。

```bash
# Day 1: 機能実装とPR作成
claude
# > 新しい検索機能を実装してPRを作成してください
# （セッションが自動的にPRにリンク）

# Day 2: レビューコメントへの対応
claude --from-pr 456
# > レビューコメントに対応してください
```

### 2. 段階的な機能追加

同じPRに対して複数回のセッションで段階的に機能を追加する場合に便利です。

```bash
# フェーズ1: 基本実装
claude
# > ダークモードの基本実装をしてPRを作成

# フェーズ2: テスト追加
claude --from-pr 789
# > テストを追加してください

# フェーズ3: ドキュメント更新
claude --from-pr 789
# > READMEを更新してください
```

### 3. CI/CDとの連携

CI/CDの失敗を修正する際、元のセッションの文脈を保持したまま作業できます。

```bash
# PRを作成後、CIが失敗
# GitHub Actionsの通知を確認

# 元のセッションを再開して修正
claude --from-pr https://github.com/team/project/pull/234
# > テストが失敗しています。修正してください
```

## コード例

### 典型的なワークフロー

```bash
# 1. 新しい機能ブランチを作成
git checkout -b feature/user-settings

# 2. Claude Codeで実装開始
claude

# 3. セッション内で実装を依頼
# > ユーザー設定画面を実装してください
# > 以下の機能を含めてください：
# > - プロフィール情報の編集
# > - パスワード変更
# > - 通知設定

# 4. 実装完了後、PRを作成
# > 実装が完了したので、PRを作成してください

# Claudeが以下を実行:
# - 変更をコミット
# - gh pr create でPRを作成
# - セッションとPRを自動リンク

# 5. 後日、レビュー対応で再開
claude --from-pr 123
# 以前の実装コンテキストを保持したまま作業継続
```

### チーム開発での活用

```bash
# 開発者A: 機能実装とPR作成
claude
# > API エンドポイントを実装してPRを作成

# 開発者B: レビュー後の修正（同じPR番号で再開）
claude --from-pr 567
# > レビューコメントの指摘事項を修正してください
```

## 注意点・Tips

### 自動リンクの条件

セッションとPRの自動リンクは、以下の場合に作成されます：

- Claude Codeのセッション内で `gh pr create` コマンドが実行された場合
- Claudeが PR作成タスクの一環として `gh pr create` を実行した場合

### 手動でのPR作成

ターミナルから直接 `gh pr create` を実行した場合は、セッションとのリンクは作成されません。Claude Codeのセッション内で実行することが重要です。

```bash
# ❌ リンクされない
gh pr create --title "Fix bug"

# ✅ リンクされる（Claude Codeセッション内で実行）
claude
# > PRを作成してください
```

### セッション履歴の管理

リンクされたセッションは、PRが閉じられた後も保持されます。過去のPRの実装履歴を参照したい場合に便利です。

```bash
# マージ済みのPRのセッションを参照
claude --from-pr 100  # マージ済みでも再開可能
```

### 複数のセッションがある場合

同じPRに複数のセッションがリンクされている場合、`--from-pr` で再開すると最新のセッションが使用されます。

### ブランチとの関連性

セッションはPR番号にリンクされますが、作業ブランチも記録されています。異なるブランチでセッションを再開すると警告が表示される場合があります。

## まとめ

PR作成時の自動セッションリンク機能により、開発からレビュー対応までのワークフローがシームレスになります。`gh pr create` を使用するだけで自動的にリンクが作成されるため、特別な操作は不要です。`--from-pr` フラグと組み合わせることで、効率的なPR駆動開発が実現できます。
