---
title: "Agent Teamsのモデル識別子修正 - Bedrock、Vertex、Foundry環境での正しいモデルID使用"
date: 2026-02-13
tags: [bugfix, agent-teams, bedrock, vertex, foundry]
---

## 原文（日本語）
Bedrock、Vertex、Foundryの各環境でAgent Teamsが誤ったモデル識別子を使用していた問題を修正しました。

## 原文（英語）
Fixed Agent Teams using wrong model identifier for Bedrock, Vertex, and Foundry customers

## 概要
Claude Code v2.1.41では、AWS Bedrock、Google Cloud Vertex AI、IBM watsonx.ai Foundryを使用しているユーザーがAgent Teams機能を利用する際に、誤ったモデル識別子が使用されていた問題が修正されました。これにより、各プラットフォームで正しいモデルが呼び出され、安定した動作が保証されます。

## 問題の詳細

### 影響を受けるプラットフォーム
- **AWS Bedrock**: Amazon Bedrockを通じてClaude APIを利用
- **Google Cloud Vertex AI**: Vertex AIでClaude APIを利用
- **IBM watsonx.ai Foundry**: Foundry経由でClaude APIを利用

### 問題の症状
Agent Teams機能を使用する際、各プラットフォーム固有のモデル識別子ではなく、標準のAnthropicモデルIDが使用されていたため、以下の問題が発生していました：

- モデル呼び出しエラー
- Agent Teamsの動作不良
- 予期しないAPI応答

## 基本的な使い方

### Agent Teamsの正常な動作確認
修正後は、各プラットフォームで正しいモデルIDが自動的に使用されます。

```bash
# Bedrock環境での確認
export AWS_PROFILE=your-profile
export CLAUDE_CODE_EXPERIMENTAL_AGENT_TEAMS=1

claude
> "チームを作成してください"

# 正しいBedrockモデルIDが使用される
# 例: anthropic.claude-3-5-sonnet-20241022-v2:0
```

### Vertex AI環境での使用
```bash
# Vertex AI環境設定
export GOOGLE_APPLICATION_CREDENTIALS=/path/to/credentials.json
export CLAUDE_CODE_EXPERIMENTAL_AGENT_TEAMS=1

claude
> "複数のエージェントでタスクを並列実行してください"

# Vertex AI固有のモデルIDが正しく使用される
```

## 実践例

### AWS Bedrockでのマルチエージェント開発
Bedrock環境でAgent Teams機能を使用して、複雑なプロジェクトを並列処理します。

```bash
# Bedrock設定
export AWS_REGION=us-east-1
export AWS_PROFILE=bedrock-profile
export CLAUDE_CODE_EXPERIMENTAL_AGENT_TEAMS=1

claude
> "フロントエンドとバックエンドの開発を並列で進めてください"

# Agent Teamsが正しいBedrockモデルIDで動作
# - フロントエンドエージェント: React UI開発
# - バックエンドエージェント: API実装
```

### Vertex AIでのデータパイプライン構築
Google Cloud環境で複数エージェントを使用してデータ処理を実装します。

```bash
# Vertex AI設定
export GOOGLE_CLOUD_PROJECT=your-project-id
export CLAUDE_CODE_EXPERIMENTAL_AGENT_TEAMS=1

claude
> "データ収集、変換、分析のパイプラインを構築してください"

# 各エージェントが正しいVertex AIモデルIDで実行
# - データ収集エージェント
# - データ変換エージェント
# - 分析エージェント
```

### Foundry環境でのエンタープライズ開発
IBM watsonx.ai Foundry環境で、コンプライアンスに準拠した開発を行います。

```bash
# Foundry設定
export CLAUDE_CODE_EXPERIMENTAL_AGENT_TEAMS=1

claude
> "セキュリティレビューとコード実装を並列で実行してください"

# Foundry固有のモデルIDで安全に動作
```

### プラットフォーム固有の設定確認
各環境で正しいモデルIDが使用されているか確認します。

```bash
# 環境変数の確認
> printenv | grep CLAUDE

# モデル設定の確認
> /settings

# Agent Teams機能のテスト
> "簡単なタスクでAgent Teamsをテストしてください"
```

## この修正の利点

### 安定性の向上
- 各プラットフォームで正しいモデルが呼び出される
- API呼び出しエラーの削減
- Agent Teamsの安定した動作

### プラットフォーム互換性
- Bedrock、Vertex AI、Foundryでの一貫した体験
- プラットフォーム固有の機能を正しく利用
- エンタープライズ環境での信頼性向上

### 開発効率の改善
- Agent Teams機能が正常に動作
- マルチエージェント開発の活用
- 複雑なタスクの並列処理が可能

## 注意点
- Agent Teams機能は実験的機能であり、環境変数`CLAUDE_CODE_EXPERIMENTAL_AGENT_TEAMS=1`の設定が必要です
- トークン消費が大きいため、適切な使用を推奨します
- 各プラットフォームで利用可能なモデルとその識別子が異なる場合があります
- 適切な認証情報とアクセス権限が必要です

## 関連情報
- [Claude Code overview - Claude Code Docs](https://code.claude.com/docs/en/overview)
- [AWS Bedrock - Claude Models](https://docs.aws.amazon.com/bedrock/latest/userguide/models-supported.html)
- [Google Cloud Vertex AI - Anthropic Models](https://cloud.google.com/vertex-ai/docs/generative-ai/model-reference/claude)
