---
title: "[VSCode] セッションリストの重複表示問題修正"
date: 2026-02-03
tags: [vscode, fix, sessions]
---

# [VSCode] セッションリストの重複表示問題修正

## 原文（日本語に翻訳）
[VSCode] 新しい会話を開始したときにセッションリストに重複したセッションが表示される問題を修正しました。

## 原文（英語）
[VSCode] Fixed duplicate sessions appearing in the session list when starting a new conversation

## 概要
VSCode拡張のClaude Codeで新しい会話を開始すると、セッション履歴リストに同じセッションが重複して表示される問題が修正されました。これにより、セッション管理画面がクリーンになり、正しいセッションを選択しやすくなりました。

## 基本的な使い方

### 修正後のセッションリスト
```
# VSCode でClaude Code拡張を使用

# サイドバーの「Sessions」パネルを開く

以前の表示（重複あり）:
├─ 📁 Project A
│  ├─ 💬 Implement auth feature      ← 重複
│  ├─ 💬 Implement auth feature      ← 重複
│  └─ 💬 Fix login bug
├─ 📁 Project B
│  ├─ 💬 Add API endpoint            ← 重複
│  ├─ 💬 Add API endpoint            ← 重複
│  ├─ 💬 Add API endpoint            ← 重複（3つも！）
│  └─ 💬 Database migration

修正後の表示（重複なし）:
├─ 📁 Project A
│  ├─ 💬 Implement auth feature
│  └─ 💬 Fix login bug
├─ 📁 Project B
│  ├─ 💬 Add API endpoint
│  └─ 💬 Database migration
```

## 実践例

### 新規セッション開始時の正常動作
```
# VSCode でClaude Code Chat パネルを開く

# 新しい会話を開始
"新しいReactコンポーネントを作成して"

# 以前の問題:
# - セッションリストに2つの同じエントリが追加される
# - "新しいReactコンポーネントを作成して"
# - "新しいReactコンポーネントを作成して" ← 重複

# 修正後:
# - セッションリストに1つだけ追加される
# - "新しいReactコンポーネントを作成して"
```

### 複数プロジェクトでの作業
```
# プロジェクトAで作業
# VSCode でプロジェクトAを開く

claude
> "認証機能を実装して"

# セッションリスト:
# Project A
#   - 認証機能を実装して

# プロジェクトBに切り替え
# VSCode でプロジェクトBを開く

claude
> "APIエンドポイントを追加して"

# 以前の問題:
# セッションリストが混乱
# Project A
#   - 認証機能を実装して
#   - 認証機能を実装して ← 重複
#   - APIエンドポイントを追加して ← 誤ったプロジェクト
# Project B
#   - APIエンドポイントを追加して
#   - APIエンドポイントを追加して ← 重複

# 修正後:
# クリーンな表示
# Project A
#   - 認証機能を実装して
# Project B
#   - APIエンドポイントを追加して
```

### セッション再開の改善
```
# VSCode でセッション一覧から選択

Sessions パネル:
├─ 💬 Implement auth feature (2026-02-01 15:30)
├─ 💬 Fix login bug (2026-02-01 10:00)
└─ 💬 Add API endpoint (2026-01-31 18:00)

# クリックして再開

# 以前:
# - 同じセッションが複数表示され、どれを選べばいいか不明
# - 誤ったセッションを選択してしまう可能性

# 修正後:
# - 各セッションは1回のみ表示
# - 正確なセッション再開が可能
```

### リアルタイム更新の正常動作
```
# セッション進行中

> "このファイルを修正して"
> "次にテストを追加して"
> "最後にコミットして"

# セッションリストの更新:

以前の問題:
├─ 💬 このファイルを修正して
├─ 💬 このファイルを修正して      ← 重複
├─ 💬 このファイルを修正して      ← さらに重複
└─ 💬 このファイルを修正して      ← 4つも表示

修正後:
├─ 💬 このファイルを修正して       ← 最新メッセージが1つのみ
└─ (最新の内容に自動更新)
```

### 検索とフィルタリングの改善
```
# Sessions パネルで検索

検索: "auth"

以前の検索結果（重複あり）:
- Implement auth feature
- Implement auth feature
- Implement auth feature
- Fix auth bug
- Fix auth bug

修正後の検索結果（クリーン）:
- Implement auth feature
- Fix auth bug
```

### セッション削除の正常動作
```
# セッションを削除

# 以前の問題:
# - 重複したエントリをすべて個別に削除する必要がある
# - 1つ削除しても、他の重複が残る

# セッション "Fix bug" を削除

削除前:
├─ 💬 Fix bug
├─ 💬 Fix bug
└─ 💬 Fix bug

削除後（以前）:
├─ 💬 Fix bug  ← まだ残っている
└─ 💬 Fix bug  ← まだ残っている

削除後（修正版）:
(セッションが完全に削除される)
```

## 注意点

- **VSCode専用の修正**: この問題はVSCode拡張版に固有のものでした。CLI版では発生していませんでした。

- **既存の重複セッション**: この修正は新しいセッションからのみ適用されます。既に重複しているセッションは手動で削除する必要があります：
  ```
  # 重複セッションを手動削除
  Sessions パネル → 右クリック → Delete
  ```

- **セッションの一意性**: セッションはセッションIDで管理されており、同じIDのセッションは1つのみ表示されるべきです。

- **リアルタイム同期**: VSCode拡張は、ファイルシステムのセッションデータとリアルタイムで同期しています。この修正により、同期のロジックが改善されました。

- **パフォーマンスへの影響**: 重複が削減されることで、セッション一覧の読み込みとレンダリングが高速化されました。

- **セッションの並び順**: セッションは最新のものが上に表示されます。タイムスタンプで並び替え可能です。

- **マルチワークスペース**: 複数のVSCodeワークスペースを開いている場合、各ワークスペースのセッションが正しく分離されて表示されます。

- **セッションメタデータ**: 各セッションには以下の情報が含まれます：
  - セッションID（一意）
  - タイトル（最初のメッセージ）
  - タイムスタンプ
  - プロジェクトパス

- **トラブルシューティング**: まだ重複が見られる場合：
  ```
  # VSCode拡張をリロード
  Ctrl+Shift+P → "Developer: Reload Window"

  # または、セッションキャッシュをクリア
  Ctrl+Shift+P → "Claude Code: Clear Session Cache"
  ```

## 関連情報

- [VSCode Extension - Claude Code Docs](https://code.claude.com/docs/en/vscode)
- [Session Management](https://code.claude.com/docs/en/sessions)
- [VSCode Extension - GitHub](https://github.com/anthropics/claude-code-vscode)
- [Resume memory optimization - v2.1.30](./2.1.30-resume-memory-optimization.md)
- [Troubleshooting VSCode Extension](https://code.claude.com/docs/en/troubleshooting#vscode)
