---
title: "EditツールがUnicodeの曲がった引用符をストレート引用符に置換してファイルを破損する問題を修正"
date: 2026-02-19
tags: [bug-fix, edit-tool, unicode, encoding]
---

## 原文（日本語に翻訳）

Editツールが編集時に Unicodeの曲がった引用符（" " ' '）をストレート引用符に置換してサイレントにファイルを破損していた問題を修正 (anthropics/claude-code#26141)

## 原文（英語）
Fixed Edit tool silently corrupting Unicode curly quotes ("\u201c" "\u201d" '\u2018' '\u2019') by replacing them with straight quotes when making edits (anthropics/claude-code#26141)

## 概要

Claude CodeのEditツールがファイルを編集する際、Unicode の「曲がった引用符」（スマートクォート）である `"` `"` `'` `'` を、通常のASCIIのストレート引用符 `"` と `'` に置換してしまい、ファイルの内容を意図せず変更してしまう問題が修正されました。この問題は特に文章・ドキュメント・設定ファイルなどでタイポグラフィ上の引用符を使用している場合に深刻な影響を及ぼしていました。

## 基本的な使い方

```markdown
<!-- 修正前: 以下のような曲がった引用符を含むファイルを編集すると -->
<!-- 他の部分の編集と関係なく引用符が置換されていた -->

彼は「このプロジェクトは"素晴らしい"と言った」と話した。
She said "Hello" and 'Goodbye'.

<!-- 修正後: Editツールは曲がった引用符をそのまま保持する -->
```

## 実践例

### Markdownドキュメントの編集

```markdown
# 書籍紹介

"天才の証明"（著者: 山田太郎）は、'読者を引き込む'物語です。
"The Great Gatsby" by F. Scott Fitzgerald is a 'classic' novel.

# Claude Code に上記ファイルの一部を編集させても
# 引用符は変更されない（修正後）
```

```bash
# Claude Codeに編集を依頼
claude -p "上記のMarkdownファイルに新しい段落を追加してください"
# 修正後: 既存の曲がった引用符はそのまま保持される
```

### 設定ファイルやJSONのUnicodeコンテンツ

```json
{
  "description": "This tool is \u201cexperimental\u201d and requires \u2018careful\u2019 usage",
  "message": "Please read the \u201cterms of service\u201d before proceeding"
}
```

```bash
# このJSONファイルを編集する際も
# Unicode曲がった引用符は変換されずに保持される（修正後）
claude -p "descriptionフィールドを更新してください"
```

### WordやMarkdownからエクスポートされたコンテンツ

```markdown
# 会議議事録

議題: \u201cプロジェクト進捗報告\u201d

発言者Aは\u2018第1フェーズは完了\u2019と述べた。
発言者Bは\u201c第2フェーズに課題がある\u201dと指摘した。
```

Word文書やリッチテキストからエクスポートされたコンテンツにはスマートクォートが含まれることが多く、修正後はこれらがEditツールで保持されます。

## 注意点

- この修正はv2.1.47以降で有効です
- 影響を受けるUnicode文字:
  - `"` (U+201C) - 左ダブル引用符
  - `"` (U+201D) - 右ダブル引用符
  - `'` (U+2018) - 左シングル引用符
  - `'` (U+2019) - 右シングル引用符
- 修正前は「サイレント」に変換されていたため、ユーザーが気づきにくい問題でした
- 既にEditツールで破損してしまったファイルは、手動での修正が必要です
- バージョン管理（git）を使用している場合、`git diff` で変更を確認することで影響を把握できます

## 関連情報

- [Claude Code EditツールとWriteツール](https://docs.anthropic.com/ja/docs/claude-code/overview)
- [Claude Code CHANGELOG](https://github.com/anthropics/claude-code/blob/main/CHANGELOG.md)
- [Issue #26141](https://github.com/anthropics/claude-code/issues/26141)
