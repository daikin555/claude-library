---
title: "認証更新エラーの修正"
date: 2026-02-16
tags: [bug-fix, authentication, oauth]
---

## 原文（日本語）
認証更新エラーを修正しました。

## 原文（英語）
Fixed auth refresh errors

## 概要
Claude Code 2.1.44では、OAuth認証トークンの自動更新時に発生していたエラーが修正されました。この修正により、認証トークンの期限切れ時に適切に更新処理が行われ、手動での再ログインが不要になります。

## 基本的な使い方
この修正はバックグラウンドで自動的に適用されます。ユーザー側で特別な操作は必要ありません。

Claude Codeを通常通り使用するだけで、認証トークンの更新が正常に行われるようになります。

```bash
# Claude Codeの起動
claude

# 認証状態の確認（CLI 2.1.41以降）
claude auth status
```

## 実践例

### トークン期限切れ時の動作
以前のバージョンでは、OAuth トークンの期限が切れると以下のようなエラーが発生していました:

```
API Error: 401
OAuth token has expired. Please obtain a new token or refresh your existing token.
```

2.1.44では、このエラーが発生せず、自動的にトークンが更新されます。

### 複数セッションでの利用
複数のClaude Codeセッションを同時に開いている場合でも、トークン更新の競合が適切に処理されるようになりました。

```bash
# ターミナル1
claude

# ターミナル2
claude

# ターミナル3（VS Code拡張機能）
# すべてのセッションで認証が正常に維持されます
```

### macOSキーチェーン連携の改善
macOS環境では、Keychainへのトークン保存・更新が正しく動作するようになりました。

手動で `/login` コマンドを繰り返し実行する必要がなくなります。

## 注意点
- この修正はClaude Code 2.1.44以降で有効です
- 既存の認証トークンに問題がある場合は、一度 `/login` コマンドでログインし直すことを推奨します
- AWS認証を使用している場合は、別途AWS認証タイムアウト修正（2.1.43）も参照してください

## 関連情報
- [Claude Code Settings - 公式ドキュメント](https://code.claude.com/docs/en/settings)
- [OAuth Token Refresh Issues - GitHub Issue #19456](https://github.com/anthropics/claude-code/issues/19456)
- [Multiple Sessions Token Race Condition - GitHub Issue #24317](https://github.com/anthropics/claude-code/issues/24317)
- [Claude Code FAQ](https://support.claude.com/en/articles/12386420-claude-code-faq)
