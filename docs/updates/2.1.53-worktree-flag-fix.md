---
title: "初回起動時に--worktreeフラグが無視される問題を修正"
date: 2026-02-25
tags: [バグ修正, worktree, Git, 初回起動]
---

## 原文（日本語に翻訳）

初回起動時に `--worktree` が無視されることがある問題を修正しました

## 原文（英語）

Fixed `--worktree` sometimes being ignored on first launch

## 概要

Claude Codeを `--worktree` フラグ付きで起動した際に、初回起動時にそのフラグが無視されてしまうことがある問題を修正しました。`--worktree` フラグはGitワークツリーで作業する際の隔離された環境を作成する機能ですが、修正前は初回起動時に意図したワークツリーではなく、メインのリポジトリ上で作業してしまうことがありました。v2.1.53の修正により、常に正しいワークツリーで作業が開始されます。

## 基本的な使い方

```bash
# ワークツリーを指定してClaude Codeを起動
claude --worktree

# または特定のワークツリーパスを指定
claude --worktree /path/to/worktree

# 修正前: 初回起動時にフラグが無視され、メインリポジトリで作業
# 修正後: 常に指定したワークツリーで正しく起動
```

## 実践例

### Gitワークツリーを使った並行開発

```bash
# 新しいワークツリーを作成（標準的なGitコマンド）
git worktree add ../feature-branch feature/new-feature

# ワークツリー上でClaude Codeを起動
cd ../feature-branch
claude --worktree

# 修正後: Claude Codeはfeature-branchのワークツリーで正しく動作
# 修正前: まれにメインブランチのコンテキストで起動してしまう
```

### 安全な実験的開発

```bash
# メインブランチを保護しながら新機能を開発
git worktree add ../experiment main

cd ../experiment
git checkout -b experimental-feature

# Claude Codeをワークツリーモードで起動
claude --worktree

# メインブランチへの影響を避けながら実験的なコード変更
> 新しいアルゴリズムを実装してテストしてください
```

### CI/CDでの並行処理

```bash
# 複数のプルリクエストを並行してレビュー
# プルリクエストA用のワークツリー
git worktree add /tmp/pr-review-123 pr/123

# Claude Codeでレビュー
claude --worktree /tmp/pr-review-123 --print "コードをレビューしてください"

# プルリクエストB用のワークツリー（並行して）
git worktree add /tmp/pr-review-456 pr/456
claude --worktree /tmp/pr-review-456 --print "コードをレビューしてください"
```

## 注意点

- この修正は v2.1.53 で適用されています
- `--worktree` フラグはGitリポジトリ内で使用する必要があります
- ワークツリー機能はGit 2.5以上で利用可能です
- ワークツリーを使うことで、メインブランチを汚さずに実験的な変更を試みることができます
- 複数のワークツリーで同時にClaude Codeを起動することも可能です
- ワークツリーの管理：
  ```bash
  # ワークツリー一覧表示
  git worktree list

  # ワークツリーの削除
  git worktree remove ../feature-branch
  ```

## 関連情報

- [Claude Code ドキュメント - Worktree](https://docs.anthropic.com/en/docs/claude-code/worktrees)
- [Git worktree ドキュメント](https://git-scm.com/docs/git-worktree)
- [バグ報告](https://github.com/anthropics/claude-code/issues)
