---
title: "スキル文字予算のコンテキストウィンドウスケーリング"
date: 2026-02-05
tags: [skills, context-window, performance, scaling]
---

## 原文（日本語訳）
スキル文字予算がコンテキストウィンドウに応じてスケール（コンテキストの2%）するようになり、より大きなコンテキストウィンドウを持つユーザーは切り捨てなしでより多くのスキル説明を見ることができます

## 原文（英語）
Skill character budget now scales with context window (2% of context), so users with larger context windows can see more skill descriptions without truncation

## 概要
Claude Code のスキルシステムにおいて、スキル説明の文字予算がコンテキストウィンドウサイズに比例するようになりました。従来は固定の 15,000 文字でしたが、v2.1.32 からはコンテキストウィンドウの 2% に動的にスケールします。これにより、大きなコンテキストウィンドウを持つユーザーはより多くのスキル情報を活用できます。

## 基本的な使い方

この機能は自動的に有効化されます。特別な設定は不要です。

```bash
# コンテキスト使用状況を確認
claude
> /context
```

スキルが多数ある場合、`/context` コマンドで「除外されたスキル」の警告が表示されるかどうか確認できます。

## 実践例

### モデルごとのスキル予算の違い

#### Sonnet 4（200K トークンコンテキスト）

```bash
# 200K トークン × 2% = 4,000 トークン相当の文字予算
# 約 16,000 文字（英語）、約 12,000 文字（日本語）のスキル説明が利用可能

claude --model sonnet
> /context
```

#### Opus 4.6（200K トークンコンテキスト）

```bash
# 同様に 200K × 2% = 約 16,000 文字の予算

claude --model opus
> /context
```

#### カスタムモデル（例: 500K トークンコンテキスト）

```bash
# 500K トークン × 2% = 10,000 トークン相当
# 約 40,000 文字のスキル説明が利用可能
# より多くのスキルを同時に活用できます

claude --model custom-large-context
```

### 多数のスキルを持つプロジェクト

プロジェクトに多数のスキルがある場合の確認方法：

```bash
# スキル一覧を確認
ls ~/.claude/skills/
ls .claude/skills/

# コンテキスト使用状況を確認
claude
> /context
```

出力例：

```
Context Usage:
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
System Prompt     │ 8,432 tokens (4.2%)
Skills            │ 3,876 tokens (1.9%)  ✓ Within budget
User Message      │ 1,024 tokens (0.5%)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Total             │ 13,332 tokens (6.7%)
Remaining         │ 186,668 tokens (93.3%)
```

### スキル予算の最適化

スキル説明を簡潔に保つ例：

```markdown
<!-- .claude/skills/deploy.md -->
---
description: Deploy application to production
---

# Deploy

Deploys the application to the production environment.

Usage: /deploy [environment]
```

詳細情報は別ファイルにリンク：

```markdown
<!-- .claude/skills/deploy.md -->
---
description: Deploy application to production
---

# Deploy

Quick deployment command. See [deployment-guide.md](./deployment-guide.md) for details.

Usage: /deploy [environment]
```

### プログレッシブディスクロージャーの活用

スキルは段階的に情報を開示する設計です：

```markdown
<!-- .claude/skills/database-migration.md -->
---
description: Run database migrations
---

# Database Migration

1. Claude scans skill name and description (30-50 tokens)
2. When triggered, reads full skill file
3. Loads referenced files (schema.sql, etc.) only if needed
```

この設計により、大量のスキルを効率的に管理できます。

## 注意点

- **予算は動的**: モデルによってコンテキストウィンドウサイズが異なるため、利用可能なスキル予算も変わります
- **2% ルール**: コンテキストウィンドウの 2% がスキル説明に割り当てられます
- **自動切り捨て**: 予算を超えるスキルは自動的に除外されます。`/context` で確認してください
- **簡潔な説明を推奨**: スキルの `description` フィールドは短く明確に書くことで、より多くのスキルを利用可能にします
- **段階的読み込み**: Claude は必要に応じてスキルの詳細を読み込むため、初期のトークン消費は最小限です
- **旧固定予算との比較**: 以前は 15,000 文字固定でしたが、200K コンテキストでは約 16,000 文字相当に増加しました

## スキル予算を最大限活用するヒント

### 1. スキル説明を最適化

```markdown
<!-- 悪い例 - 冗長 -->
---
description: This is a comprehensive deployment skill that will deploy your application to various environments including production, staging, and development, with support for multiple deployment strategies
---

<!-- 良い例 - 簡潔 -->
---
description: Deploy app to prod/staging/dev environments
---
```

### 2. 関連スキルをグループ化

```bash
.claude/skills/
├── deployment/
│   ├── deploy-prod.md
│   ├── deploy-staging.md
│   └── rollback.md
└── testing/
    ├── run-tests.md
    └── generate-coverage.md
```

### 3. 使用頻度に応じて整理

よく使うスキルは簡潔に保ち、たまにしか使わないスキルは必要に応じて読み込まれるようにします。

## 関連情報

- [Extend Claude with skills - Claude Code Docs](https://code.claude.com/docs/en/skills)
- [Context windows - Claude API Docs](https://platform.claude.com/docs/en/build-with-claude/context-windows)
- [Agent Skills - Claude API Docs](https://platform.claude.com/docs/en/agents-and-tools/agent-skills/overview)
- [Equipping agents for the real world with Agent Skills - Anthropic Engineering](https://www.anthropic.com/engineering/equipping-agents-for-the-real-world-with-agent-skills)
- [Context Window Management - DeepWiki](https://deepwiki.com/FlorianBruniaux/claude-code-ultimate-guide/3.2-context-window-management)
