---
title: "MCPサーバーフェッチキャッシュが切断時にクリアされないメモリリーク修正"
date: 2026-02-28
tags: [bug-fix, memory, mcp, cache, stability]
---

# MCPサーバーフェッチキャッシュが切断時にクリアされないメモリリーク修正

## 原文（日本語に翻訳）

MCPサーバーのフェッチキャッシュが切断時にクリアされず、頻繁に再接続するサーバーで増大するメモリ使用量の原因となっていたメモリリークを修正しました。

## 原文（英語）

Fixed a memory leak where MCP server fetch caches were not cleared on disconnect, causing growing memory usage with servers that reconnect frequently

## 概要

Claude Code v2.1.63で、MCPサーバーが切断する際にフェッチキャッシュが適切にクリアされない問題が修正されました。頻繁に再接続するMCPサーバーを使用している場合、このキャッシュが蓄積し続けてメモリ使用量が増大する原因となっていました。修正後は、MCPサーバーが切断するたびに関連するキャッシュが適切にクリアされます。

## 基本的な使い方

この修正はバックグラウンドで自動的に適用されます。ユーザー側での操作は不要です。

## 実践例

### 影響を受けるシナリオ

- ネットワーク不安定な環境でのMCPサーバー使用
- 自動的に再起動・再接続するMCPサーバー（開発中のサーバーなど）
- 多数のMCPサーバーを同時に使用する環境

### 修正後の改善

```
# MCPサーバー接続サイクルとメモリ動作
修正前：
接続 → キャッシュ作成
切断 → キャッシュ残留
再接続 → 新キャッシュ追加（蓄積）
...→ メモリ無制限増加

修正後：
接続 → キャッシュ作成
切断 → キャッシュクリア
再接続 → 新キャッシュ作成（適切なサイズ維持）
```

## 注意点

- v2.1.63にアップデートすることで自動的に修正が適用されます
- 開発中のMCPサーバーや、不安定な接続環境で使用するユーザーに特に効果があります

## 関連情報

- [Claude Code MCP設定](https://docs.anthropic.com/ja/docs/claude-code/mcp)
- [Model Context Protocol](https://modelcontextprotocol.io/)
