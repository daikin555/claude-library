---
title: "ファイル操作ツールの優先使用への改善"
date: 2026-01-28
tags: [improved, tools, file-operations, bash]
---

## 原文（日本語訳）
Claudeがbashの同等コマンド（cat、sed、awk）よりもファイル操作ツール（Read、Edit、Write）を優先して使用するように改善しました

## 原文（英語）
Improved Claude to prefer file operation tools (Read, Edit, Write) over bash equivalents (cat, sed, awk)

## 概要
Claudeがファイルを扱う際、`cat`、`sed`、`awk`などのbashコマンドではなく、専用のファイル操作ツール（Read、Edit、Write）を優先的に使用するようになりました。これにより、より安全で予測可能な動作が実現されます。

## 基本的な使い方

```bash
claude
> README.md を確認してください

# 改善前: cat コマンドを使用
Bash: cat README.md

# 改善後: Read ツールを使用
Read: README.md
```

## 実践例

### ファイルの読み込み

```bash
claude
> package.json の内容を見せてください

# Read ツールを使用（以前は cat を使用していた）
Read: package.json
```

### ファイルの編集

```bash
claude
> src/config.ts の設定値を更新してください

# Edit ツールを使用（以前は sed を使用することがあった）
Edit: src/config.ts
- const API_URL = "http://localhost:3000"
+ const API_URL = "https://api.example.com"
```

### 新規ファイルの作成

```bash
claude
> 新しいコンポーネントファイルを作成してください

# Write ツールを使用（以前は echo や cat > を使用することがあった）
Write: src/components/NewComponent.tsx
```

### 複数ファイルの処理

```bash
claude
> src/ディレクトリのすべての TypeScript ファイルを確認

# Read ツールで効率的に処理
Read: src/index.ts
Read: src/app.ts
Read: src/utils.ts

# 以前は bash ループで cat を実行していた
```

## 利点

### より安全な操作

専用ツールは以下の点で優れています。

- **パーミッション管理**: ファイル操作ツールは適切な権限チェックを行います
- **エラーハンドリング**: より詳細なエラー情報が提供されます
- **履歴追跡**: 操作履歴が明確に記録されます

### 予測可能な動作

```bash
# bashコマンドの場合、シェルの状態に依存
Bash: cat file.txt  # シェル環境により結果が異なる可能性

# ファイル操作ツールは一貫した動作
Read: file.txt  # 常に同じ方法で読み込み
```

### IDE統合の向上

VS Code拡張を使用している場合、ファイル操作ツールはエディタと統合されます。

```bash
# Edit ツールは VS Code のディフビューアーで表示される
Edit: src/app.ts
# → VS Code でビジュアルな差分表示
```

## 注意点

- **bash使用の制限なし**: 必要に応じてbashコマンドも引き続き使用できます
- **複雑な操作**: 複雑なテキスト処理が必要な場合は、Claudeが適切にbashツールを選択することもあります
- **パフォーマンス**: 専用ツールは最適化されており、大きなファイルでも効率的に動作します
- **システムプロンプト**: この改善はシステムプロンプトの更新により実現されており、ユーザー操作は不要です

## 関連情報

- [Claude Code Changelog - v2.1.21](https://github.com/anthropics/claude-code/blob/main/CHANGELOG.md)
- [File Operation Tools Documentation](https://code.claude.com/docs/en/tools)
- [Tool Preferences System Prompt](https://github.com/anthropics/claude-code/blob/main/CHANGELOG.md#2131)
