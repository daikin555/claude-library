---
title: "è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›´æ™‚ã®å¤ã„æ¨©é™ãƒ«ãƒ¼ãƒ«ã®ã‚¯ãƒªã‚¢å‡¦ç†ã®ä¿®æ­£"
date: 2026-02-13
tags: [bugfix, permissions, settings, configuration]
---

## åŸæ–‡ï¼ˆæ—¥æœ¬èªï¼‰
è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ãŒãƒ‡ã‚£ã‚¹ã‚¯ä¸Šã§å¤‰æ›´ã•ã‚ŒãŸéš›ã«ã€å¤ã„æ¨©é™ãƒ«ãƒ¼ãƒ«ã‚’ã‚¯ãƒªã‚¢ã™ã‚‹å‡¦ç†ã‚’ä¿®æ­£ã—ã¾ã—ãŸã€‚

## åŸæ–‡ï¼ˆè‹±èªï¼‰
Fixed clear stale permission rules when settings change on disk

## æ¦‚è¦
Claude Code v2.1.41ã§ã¯ã€è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ`~/.claude/settings.json`ï¼‰ãŒãƒ‡ã‚£ã‚¹ã‚¯ä¸Šã§ç›´æ¥ç·¨é›†ã•ã‚ŒãŸéš›ã«ã€å¤ã„æ¨©é™ãƒ«ãƒ¼ãƒ«ãŒæ­£ã—ãã‚¯ãƒªã‚¢ã•ã‚Œãšã€æ–°ã—ã„è¨­å®šãŒåæ˜ ã•ã‚Œãªã„å•é¡ŒãŒä¿®æ­£ã•ã‚Œã¾ã—ãŸã€‚ã“ã‚Œã«ã‚ˆã‚Šã€è¨­å®šå¤‰æ›´ãŒå³åº§ã«åæ˜ ã•ã‚Œã€äºˆæœŸã—ãªã„å‹•ä½œã‚’é˜²ã’ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

## å•é¡Œã®èƒŒæ™¯

### æ¨©é™ãƒ«ãƒ¼ãƒ«ã¨ã¯
æ¨©é™ãƒ«ãƒ¼ãƒ«ã¯ã€Claude CodeãŒãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œã‚„ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œã‚’è¡Œã†éš›ã®æ‰¿èªãƒãƒªã‚·ãƒ¼ã‚’å®šç¾©ã—ã¾ã™ã€‚ä¾‹ãˆã°ã€ç‰¹å®šã®ãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®è‡ªå‹•æ‰¿èªã‚„ã€å±é™ºãªã‚³ãƒãƒ³ãƒ‰ã®ãƒ–ãƒ­ãƒƒã‚¯ãªã©ã§ã™ã€‚

### ç™ºç”Ÿã—ã¦ã„ãŸå•é¡Œ
è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¤–éƒ¨ã‚¨ãƒ‡ã‚£ã‚¿ã§ç·¨é›†ã—ãŸå¾Œã€Claude Codeã‚»ãƒƒã‚·ãƒ§ãƒ³å†…ã§å¤ã„æ¨©é™ãƒ«ãƒ¼ãƒ«ãŒæ®‹ã‚Šç¶šã‘ã¦ã„ã¾ã—ãŸã€‚

**ä¿®æ­£å‰:**
```bash
# ~/.claude/settings.jsonã‚’ç·¨é›†ï¼ˆå¤–éƒ¨ã‚¨ãƒ‡ã‚£ã‚¿ï¼‰
{
  "permissions": {
    "autoAllow": {
      "Read": ["src/**/*.ts"]
    }
  }
}

# Claude Codeã‚»ãƒƒã‚·ãƒ§ãƒ³å†…
> "src/auth.tsã‚’èª­ã‚“ã§ãã ã•ã„"
â¸ï¸  Permission required: Read src/auth.ts
# â† è¨­å®šã§è‡ªå‹•æ‰¿èªã—ãŸã¯ãšãªã®ã«ã€æ‰¿èªã‚’æ±‚ã‚ã‚‰ã‚Œã‚‹
```

**ä¿®æ­£å¾Œ:**
```bash
# ~/.claude/settings.jsonã‚’ç·¨é›†ï¼ˆå¤–éƒ¨ã‚¨ãƒ‡ã‚£ã‚¿ï¼‰
{
  "permissions": {
    "autoAllow": {
      "Read": ["src/**/*.ts"]
    }
  }
}

# Claude CodeãŒè¨­å®šå¤‰æ›´ã‚’æ¤œå‡ºã—ã€ãƒ«ãƒ¼ãƒ«ã‚’ãƒªãƒ­ãƒ¼ãƒ‰
Settings reloaded: New permission rules applied

# Claude Codeã‚»ãƒƒã‚·ãƒ§ãƒ³å†…
> "src/auth.tsã‚’èª­ã‚“ã§ãã ã•ã„"
âœ“ Reading src/auth.ts (auto-approved)
# â† è¨­å®šãŒå³åº§ã«åæ˜ ã•ã‚Œã‚‹
```

## åŸºæœ¬çš„ãªä½¿ã„æ–¹

### è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ç·¨é›†ã¨åæ˜ 
ä¿®æ­£å¾Œã¯ã€è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†ã™ã‚‹ã¨è‡ªå‹•çš„ã«åæ˜ ã•ã‚Œã¾ã™ã€‚

```bash
# ã‚¿ãƒ¼ãƒŸãƒŠãƒ«1: Claude Codeå®Ÿè¡Œä¸­
claude
>

# ã‚¿ãƒ¼ãƒŸãƒŠãƒ«2: è¨­å®šã‚’ç·¨é›†
vim ~/.claude/settings.json

# è¨­å®šã‚’ä¿å­˜

# ã‚¿ãƒ¼ãƒŸãƒŠãƒ«1: è‡ªå‹•çš„ã«è¨­å®šãŒãƒªãƒ­ãƒ¼ãƒ‰ã•ã‚Œã‚‹
âš™ï¸  Settings file changed, reloading permissions...
âœ“ New permission rules applied
```

## å®Ÿè·µä¾‹

### è‡ªå‹•æ‰¿èªãƒ«ãƒ¼ãƒ«ã®è¿½åŠ 
é–‹ç™ºä¸­ã«ã€é »ç¹ã«ä½¿ç”¨ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è‡ªå‹•æ‰¿èªãƒªã‚¹ãƒˆã«è¿½åŠ ã—ã¾ã™ã€‚

```bash
# Claude Codeå®Ÿè¡Œä¸­
> "tests/unit/auth.test.tsã‚’èª­ã‚“ã§ãã ã•ã„"
â¸ï¸  Permission required: Read tests/unit/auth.test.ts
[Approve]

# è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†ã—ã¦è‡ªå‹•æ‰¿èªã‚’è¿½åŠ 
# ~/.claude/settings.json
{
  "permissions": {
    "autoAllow": {
      "Read": ["tests/**/*.test.ts"]
    }
  }
}

# ä¿®æ­£å¾Œ: è¨­å®šãŒå³åº§ã«åæ˜ ã•ã‚Œã‚‹
âš™ï¸  Settings reloaded

# æ¬¡å›ã‹ã‚‰è‡ªå‹•æ‰¿èªã•ã‚Œã‚‹
> "tests/unit/user.test.tsã‚’èª­ã‚“ã§ãã ã•ã„"
âœ“ Reading tests/unit/user.test.ts (auto-approved)
```

### ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œãƒãƒªã‚·ãƒ¼ã®å¤‰æ›´
ç‰¹å®šã®ã‚³ãƒãƒ³ãƒ‰ã‚’è‡ªå‹•æ‰¿èªã«è¿½åŠ ã—ã¾ã™ã€‚

```bash
# ãƒ†ã‚¹ãƒˆã‚³ãƒãƒ³ãƒ‰ã®å®Ÿè¡Œ
> "ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„"
â¸ï¸  Permission required: Bash "npm test"
[Approve]

# è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†
# ~/.claude/settings.json
{
  "permissions": {
    "autoAllow": {
      "Bash": ["npm test", "npm run build"]
    }
  }
}

# ä¿®æ­£å¾Œ: å³åº§ã«åæ˜ ã•ã‚Œã‚‹
âš™ï¸  Settings reloaded

# æ¬¡å›ã‹ã‚‰è‡ªå‹•æ‰¿èªã•ã‚Œã‚‹
> "ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„"
âœ“ Running: npm test (auto-approved)
```

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒªã‚·ãƒ¼ã®æ›´æ–°
ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¦ä»¶ã«å¿œã˜ã¦ã€å±é™ºãªã‚³ãƒãƒ³ãƒ‰ã‚’ãƒ–ãƒ­ãƒƒã‚¯ã—ã¾ã™ã€‚

```bash
# è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†
# ~/.claude/settings.json
{
  "permissions": {
    "deny": {
      "Bash": [
        "rm -rf /*",
        "dd if=*",
        "mkfs*",
        "format*"
      ]
    }
  }
}

# ä¿®æ­£å¾Œ: è¨­å®šãŒå³åº§ã«é©ç”¨ã•ã‚Œã‚‹
âš™ï¸  Security rules updated

# å±é™ºãªã‚³ãƒãƒ³ãƒ‰ãŒãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã‚‹
> bash -c "rm -rf /tmp/test"
âŒ Blocked by security policy: rm -rf
ğŸ’¡ This operation is not allowed
```

### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå›ºæœ‰ã®è¨­å®š
ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã”ã¨ã«ç•°ãªã‚‹æ¨©é™ãƒ«ãƒ¼ãƒ«ã‚’è¨­å®šã—ã¾ã™ã€‚

```bash
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆAç”¨ã®è¨­å®š
# ~/projects/projectA/.claude/settings.json
{
  "permissions": {
    "autoAllow": {
      "Read": ["src/**/*"],
      "Write": ["docs/**/*.md"]
    }
  }
}

# Claude Codeã‚’èµ·å‹•
cd ~/projects/projectA
claude

# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨­å®šãŒèª­ã¿è¾¼ã¾ã‚Œã‚‹
âš™ï¸  Project settings loaded

# è¨­å®šã‚’å¤‰æ›´
vim .claude/settings.json

# ä¿®æ­£å¾Œ: å³åº§ã«åæ˜ ã•ã‚Œã‚‹
âš™ï¸  Settings reloaded (project-specific)
```

### ãƒãƒ¼ãƒ å…±æœ‰è¨­å®šã®åŒæœŸ
ãƒãƒ¼ãƒ ã§å…±æœ‰ã™ã‚‹è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’åŒæœŸã—ã¾ã™ã€‚

```bash
# GitçµŒç”±ã§æœ€æ–°ã®è¨­å®šã‚’å–å¾—
git pull origin main
# â† .claude/settings.jsonãŒæ›´æ–°ã•ã‚Œã‚‹

# Claude Codeå®Ÿè¡Œä¸­
# ä¿®æ­£å¾Œ: è‡ªå‹•çš„ã«æ–°ã—ã„è¨­å®šã‚’æ¤œå‡ºãƒ»é©ç”¨
âš™ï¸  Settings file changed on disk
âš™ï¸  Reloading team permissions...
âœ“ Team permission rules applied

# æ–°ã—ã„ãƒ«ãƒ¼ãƒ«ãŒå³åº§ã«æœ‰åŠ¹ã«ãªã‚‹
```

### é–‹ç™ºç’°å¢ƒã¨æœ¬ç•ªç’°å¢ƒã®åˆ‡ã‚Šæ›¿ãˆ
ç’°å¢ƒã”ã¨ã«ç•°ãªã‚‹æ¨©é™ãƒ«ãƒ¼ãƒ«ã‚’åˆ‡ã‚Šæ›¿ãˆã¾ã™ã€‚

```bash
# é–‹ç™ºç’°å¢ƒè¨­å®šã‚’é©ç”¨
cp .claude/settings.dev.json .claude/settings.json

# ä¿®æ­£å¾Œ: å³åº§ã«æ¤œå‡ºãƒ»é©ç”¨
âš™ï¸  Settings reloaded
âœ“ Development permissions active

# ã‚ˆã‚Šç·©ã„æ¨©é™ã§ä½œæ¥­å¯èƒ½

# æœ¬ç•ªç’°å¢ƒè¨­å®šã«åˆ‡ã‚Šæ›¿ãˆ
cp .claude/settings.prod.json .claude/settings.json

# ä¿®æ­£å¾Œ: å³åº§ã«æ¤œå‡ºãƒ»é©ç”¨
âš™ï¸  Settings reloaded
âœ“ Production permissions active (restricted)
```

## ã“ã®ä¿®æ­£ã®åˆ©ç‚¹

### è¨­å®šåæ˜ ã®è¿…é€ŸåŒ–
- ãƒ•ã‚¡ã‚¤ãƒ«ç·¨é›†ãŒå³åº§ã«åæ˜ ã•ã‚Œã‚‹
- ã‚»ãƒƒã‚·ãƒ§ãƒ³å†èµ·å‹•ä¸è¦
- ã‚¹ãƒ ãƒ¼ã‚ºãªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

### äºˆæœŸã—ãªã„å‹•ä½œã®é˜²æ­¢
- å¤ã„æ¨©é™ãƒ«ãƒ¼ãƒ«ãŒæ®‹ã‚‰ãªã„
- è¨­å®šã¨å®Ÿéš›ã®å‹•ä½œãŒä¸€è‡´
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒªã‚·ãƒ¼ã®ç¢ºå®Ÿãªé©ç”¨

### é–‹ç™ºåŠ¹ç‡ã®å‘ä¸Š
- è¨­å®šã®è©¦è¡ŒéŒ¯èª¤ãŒå®¹æ˜“
- ãƒãƒ¼ãƒ è¨­å®šã®åŒæœŸãŒç°¡å˜
- ç’°å¢ƒåˆ‡ã‚Šæ›¿ãˆãŒã‚¹ãƒ ãƒ¼ã‚º

## è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ç›£è¦–

### è‡ªå‹•ãƒªãƒ­ãƒ¼ãƒ‰ã®ãƒˆãƒªã‚¬ãƒ¼
ä»¥ä¸‹ã®å ´åˆã«è¨­å®šãŒè‡ªå‹•çš„ã«ãƒªãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¾ã™ï¼š

1. `~/.claude/settings.json`ã®å¤‰æ›´
2. `.claude/settings.json`ï¼ˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå›ºæœ‰ï¼‰ã®å¤‰æ›´
3. Git pullã«ã‚ˆã‚‹è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«æ›´æ–°
4. å¤–éƒ¨ã‚¨ãƒ‡ã‚£ã‚¿ã§ã®ç·¨é›†

### ãƒªãƒ­ãƒ¼ãƒ‰é€šçŸ¥
```text
âš™ï¸  Settings file changed, reloading...
âœ“ Permission rules updated
âœ“ [N] auto-allow rules loaded
âœ“ [M] deny rules loaded
```

## æ³¨æ„ç‚¹
- è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®æ§‹æ–‡ã‚¨ãƒ©ãƒ¼ãŒã‚ã‚‹å ´åˆã€ãƒªãƒ­ãƒ¼ãƒ‰ã¯å¤±æ•—ã—ã¾ã™
- å¤±æ•—æ™‚ã¯æ—¢å­˜ã®è¨­å®šãŒä¿æŒã•ã‚Œã¾ã™
- è¨­å®šã®å¤‰æ›´ã¯ç¾åœ¨ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã«ã®ã¿å½±éŸ¿ã—ã¾ã™ï¼ˆä»–ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã«ã¯å½±éŸ¿ã—ã¾ã›ã‚“ï¼‰
- è¤‡æ•°ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã™ã‚‹å ´åˆã€å„ªå…ˆé †ä½ã¯: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå›ºæœ‰ > ã‚°ãƒ­ãƒ¼ãƒãƒ«

## è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ä¾‹

### åŸºæœ¬çš„ãªæ¨©é™è¨­å®š
```json
{
  "permissions": {
    "autoAllow": {
      "Read": [
        "src/**/*.ts",
        "tests/**/*.ts",
        "README.md"
      ],
      "Write": [
        "docs/**/*.md"
      ],
      "Bash": [
        "npm test",
        "npm run build",
        "git status"
      ]
    },
    "deny": {
      "Bash": [
        "rm -rf /*",
        "sudo *"
      ]
    }
  }
}
```

### ç’°å¢ƒåˆ¥è¨­å®š
```json
{
  "permissions": {
    "autoAllow": {
      "Read": ["**/*"],
      "Bash": ["npm *", "git *"]
    }
  },
  "environment": "development"
}
```

## é–¢é€£æƒ…å ±
- [Claude Code Settings Guide](https://code.claude.com/docs/en/settings)
- [Permissions Documentation](https://code.claude.com/docs/en/permissions)
- [Claude Code - How it works](https://code.claude.com/docs/en/how-claude-code-works)
